{"name":"dacfabbeab","url":"https://account.fuhaogou.com","showName":"门店助手","appid":"ayoutuan.app","icon":"","iconPath":"","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":true,"version":"1.5.0","preview":"desktop","platform":["1-1"],"width":800,"height":600,"desc":"","jsFile":[],"filterCss":"","customJs":"// 全局配置：目标域名、页面路径及对应CSS映射（保留原链接，优化加载逻辑）\nconst TARGET_DOMAIN = 'fuhaogou.com';\nconst LOGIN_PAGE_PATH = '/account#/login';\nconst PAGE_CSS_MAP = {\n    login: 'https://server.kexuny.cn/work/midd.css',\n    chooseStore: 'https://server.kexuny.cn/work/mdxz.css',\n    shop: 'https://server.kexuny.cn/work/shop.css',\n    settlement: 'https://server.kexuny.cn/work/tixian.css', // 新增提现页面CSS\n    mine: 'https://server.kexuny.cn/work/mine.css' // 【改动1】新增mine页面CSS映射\n};\n// 新增：远程shop.js地址\nconst REMOTE_SHOP_JS_URL = 'https://server.kexuny.cn/work/shop.js';\n// 新增：提现页面JS地址\nconst REMOTE_SETTLEMENT_JS_URL = 'https://server.kexuny.cn/work/tixian.js';\n// 【改动2】新增：mine页面JS地址\nconst REMOTE_MINE_JS_URL = 'https://server.kexuny.cn/work/mine.js';\n\n// 1. 域名校验（保持不变）\nfunction isTargetDomain() {\n    const currentDomain = window.location.hostname;\n    const isMatch = currentDomain.includes(TARGET_DOMAIN);\n    if (!isMatch) {\n        console.log(`当前域名${currentDomain}非目标域名，停止执行脚本`);\n    }\n    return isMatch;\n}\n\n// 2. 页面类型判断（优化：处理hash变化后的路径解析，新增提现页面判断）\nfunction getCurrentPageType() {\n    const pathname = window.location.pathname || '';\n    const hash = window.location.hash || '';\n    const currentFullPath = (pathname + hash).trim();\n    \n    if (window.lastPageFullPath!== currentFullPath) {\n        console.log(`当前页面完整路径：${currentFullPath}`);\n        window.lastPageFullPath = currentFullPath;\n    }\n    \n    // 新增：提现页面判断\n    if (currentFullPath.includes('/shop#/apps/multistore/settlement/overview/apply') && \n        currentFullPath.includes('type=goods')) {\n        return'settlement';\n    }\n    // 【改动3】新增：mine页面判断（匹配business路径）\n    if (currentFullPath.includes('/shop#/apps/multistore/store/business')) {\n        return'mine';\n    }\n    if (currentFullPath === LOGIN_PAGE_PATH) {\n        return 'login';\n    } else if (currentFullPath.includes('/account#/shops/chooseStore')) {\n        return 'chooseStore';\n    } else if (pathname === '/shop' || currentFullPath.includes('/shop#')) {\n        return 'shop';\n    } else {\n        return 'unknown';\n    }\n}\n\n// 3. 登录页校验（保持不变）\nfunction isLoginPage() {\n    return getCurrentPageType() === 'login';\n}\n\n// 【改动4】新增：动态加载远程mine.js文件（避免重复加载+DOM就绪检查）\nfunction loadRemoteMineJs() {\n    if (!isTargetDomain()) return;\n    // 检查是否已加载\n    if (document.querySelector(`script[src=\"${REMOTE_MINE_JS_URL}\"]`)) {\n        console.log(`远程JS文件${REMOTE_MINE_JS_URL}已加载，无需重复加载`);\n        return;\n    }\n    \n    // 等待DOM完全就绪后加载JS\n    const loadScript = () => {\n        const script = document.createElement('script');\n        script.src = REMOTE_MINE_JS_URL;\n        script.type = 'text/javascript';\n        script.async = true;\n        \n        script.onload = function() {\n            console.log(`远程JS文件${REMOTE_MINE_JS_URL}加载成功`);\n        };\n        \n        script.onerror = function() {\n            console.error(`远程JS文件${REMOTE_MINE_JS_URL}加载失败，1秒后重试`);\n            setTimeout(loadRemoteMineJs, 1000);\n        };\n        \n        // 安全插入script（优先head，若无则body）\n        if (document.head) {\n            document.head.appendChild(script);\n        } else if (document.body) {\n            document.body.appendChild(script);\n        } else {\n            setTimeout(loadScript, 200);\n        }\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        loadScript();\n    } else {\n        document.addEventListener('DOMContentLoaded', loadScript);\n    }\n}\n\n// 新增：动态加载远程settlement.js文件（避免重复加载+DOM就绪检查）\nfunction loadRemoteSettlementJs() {\n    if (!isTargetDomain()) return;\n    // 检查是否已加载\n    if (document.querySelector(`script[src=\"${REMOTE_SETTLEMENT_JS_URL}\"]`)) {\n        console.log(`远程JS文件${REMOTE_SETTLEMENT_JS_URL}已加载，无需重复加载`);\n        return;\n    }\n    \n    // 等待DOM完全就绪后加载JS\n    const loadScript = () => {\n        const script = document.createElement('script');\n        script.src = REMOTE_SETTLEMENT_JS_URL;\n        script.type = 'text/javascript';\n        script.async = true;\n        \n        script.onload = function() {\n            console.log(`远程JS文件${REMOTE_SETTLEMENT_JS_URL}加载成功`);\n        };\n        \n        script.onerror = function() {\n            console.error(`远程JS文件${REMOTE_SETTLEMENT_JS_URL}加载失败，1秒后重试`);\n            setTimeout(loadRemoteSettlementJs, 1000);\n        };\n        \n        // 安全插入script（优先head，若无则body）\n        if (document.head) {\n            document.head.appendChild(script);\n        } else if (document.body) {\n            document.body.appendChild(script);\n        } else {\n            setTimeout(loadScript, 200);\n        }\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        loadScript();\n    } else {\n        document.addEventListener('DOMContentLoaded', loadScript);\n    }\n}\n\n// 新增：动态加载远程shop.js文件（避免重复加载+DOM就绪检查）\nfunction loadRemoteShopJs() {\n    if (!isTargetDomain()) return;\n    // 检查是否已加载\n    if (document.querySelector(`script[src=\"${REMOTE_SHOP_JS_URL}\"]`)) {\n        console.log(`远程JS文件${REMOTE_SHOP_JS_URL}已加载，无需重复加载`);\n        // 强制触发导航栏注入（兜底）\n        if (typeof window.injectBottomNav === 'function') {\n            window.injectBottomNav();\n        }\n        return;\n    }\n    \n    // 等待DOM完全就绪后加载JS\n    const loadScript = () => {\n        const script = document.createElement('script');\n        script.src = REMOTE_SHOP_JS_URL;\n        script.type = 'text/javascript';\n        script.async = true;\n        \n        script.onload = function() {\n            console.log(`远程JS文件${REMOTE_SHOP_JS_URL}加载成功`);\n            // 立即调用导航栏注入\n            if (typeof window.injectBottomNav === 'function') {\n                window.injectBottomNav();\n            }\n        };\n        \n        script.onerror = function() {\n            console.error(`远程JS文件${REMOTE_SHOP_JS_URL}加载失败，1秒后重试`);\n            setTimeout(loadRemoteShopJs, 1000);\n        };\n        \n        // 安全插入script（优先head，若无则body）\n        if (document.head) {\n            document.head.appendChild(script);\n        } else if (document.body) {\n            document.body.appendChild(script);\n        } else {\n            setTimeout(loadScript, 200);\n        }\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        loadScript();\n    } else {\n        document.addEventListener('DOMContentLoaded', loadScript);\n    }\n}\n\nconsole.log(\n    '%cbuild from PakePlus： https://github.com/Sjj1024/PakePlus',\n    'color:orangered;font-weight:bolder'\n);\n\n// 全局标记（优化状态管理+初始化为null）\nlet currentCssKey = null;\nlet isCssLoaded = false;\nlet isLoadingCss = false;\nlet cssLinkElement = null;\n\n// ✅ 核心优化1：预加载CSS（增加DOM就绪检查）\nfunction preloadCss(cssKey) {\n    if (!isTargetDomain() ||!PAGE_CSS_MAP[cssKey]) return;\n    \n    const targetCssUrl = PAGE_CSS_MAP[cssKey];\n    console.log(`预加载CSS：${targetCssUrl}`);\n    \n    // 等待DOM就绪后创建link元素\n    const createPreloadLink = () => {\n        const preloadLink = document.createElement('link');\n        preloadLink.rel = 'preload';\n        preloadLink.href = targetCssUrl;\n        preloadLink.as = 'style';\n        preloadLink.crossOrigin = 'anonymous';\n        \n        preloadLink.onload = function() {\n            preloadLink.rel = 'stylesheet';\n            console.log(`CSS预加载完成：${targetCssUrl}`);\n            cssLinkElement = preloadLink;\n            isCssLoaded = true;\n            isLoadingCss = false;\n            // 预加载完成后加载JS（shop页面或提现页面）\n            if (cssKey === 'shop') {\n                loadRemoteShopJs();\n            } else if (cssKey === 'settlement') { // 新增提现页面JS加载\n                loadRemoteSettlementJs();\n            } else if (cssKey === 'mine') { // 【改动5】新增mine页面JS加载\n                loadRemoteMineJs();\n            }\n        };\n        \n        preloadLink.onerror = function() {\n            console.error(`CSS预加载失败：${targetCssUrl}`);\n            isLoadingCss = false;\n            loadCss(cssKey); // 降级加载\n        };\n        \n        // 安全插入到head（若无则body）\n        if (document.head) {\n            document.head.appendChild(preloadLink);\n        } else if (document.body) {\n            document.body.appendChild(preloadLink);\n        } else {\n            setTimeout(createPreloadLink, 200);\n            return;\n        }\n        \n        isLoadingCss = true;\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        createPreloadLink();\n    } else {\n        document.addEventListener('DOMContentLoaded', createPreloadLink);\n    }\n}\n\n// ✅ 核心优化2：修复loadCss的insertBefore空指针错误\nfunction loadCss(cssKey) {\n    if (!isTargetDomain() || isLoadingCss || isCssLoaded ||!PAGE_CSS_MAP[cssKey]) return;\n    \n    isLoadingCss = true;\n    const targetCssUrl = PAGE_CSS_MAP[cssKey];\n    console.log(`开始加载CSS：${targetCssUrl}`);\n    \n    // 复用缓存link元素（增加存在性检查）\n    if (cssLinkElement && cssLinkElement.href === targetCssUrl) {\n        const insertCss = () => {\n            try {\n                if (document.head) {\n                    document.head.appendChild(cssLinkElement);\n                } else if (document.body) {\n                    document.body.appendChild(cssLinkElement);\n                } else {\n                    setTimeout(insertCss, 200);\n                    return;\n                }\n                isCssLoaded = true;\n                isLoadingCss = false;\n                console.log(`复用缓存的CSS link元素`);\n                // 加载完成后加载JS（shop页面或提现页面）\n                if (cssKey === 'shop') {\n                    loadRemoteShopJs();\n                } else if (cssKey === 'settlement') { // 新增提现页面JS加载\n                    loadRemoteSettlementJs();\n                } else if (cssKey === 'mine') { // 【改动6】新增mine页面JS加载\n                    loadRemoteMineJs();\n                }\n            } catch (e) {\n                console.error(`复用CSS失败：`, e);\n                isLoadingCss = false;\n                setTimeout(() => loadCss(cssKey), 1000);\n            }\n        };\n        insertCss();\n        return;\n    }\n    \n    // 创建新link元素（增加DOM就绪检查）\n    const createLink = () => {\n        const link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.href = targetCssUrl;\n        link.crossOrigin = 'anonymous';\n        link.media = 'all';\n        link.setAttribute('importance', 'high');\n        \n        link.onload = function() {\n            console.log(`CSS加载成功：${targetCssUrl}`);\n            currentCssKey = cssKey;\n            isCssLoaded = true;\n            isLoadingCss = false;\n            cssLinkElement = link;\n            // 加载完成后加载JS（shop页面或提现页面）\n            if (cssKey === 'shop') {\n                loadRemoteShopJs();\n            } else if (cssKey === 'settlement') { // 新增提现页面提现加载\n                loadRemoteSettlementJs();\n            } else if (cssKey === 'mine') { // 【改动7】新增mine页面JS加载\n                loadRemoteMineJs();\n            }\n        };\n        \n        link.onerror = function() {\n            console.error(`CSS加载失败：${targetCssUrl}`);\n            isLoadingCss = false;\n            // 仅重试1次\n            setTimeout(() => {\n                if (!isCssLoaded) loadCss(cssKey);\n            }, 1000);\n        };\n        \n        // 安全插入link（修复insertBefore空指针）\n        try {\n            if (document.head) {\n                if (document.head.firstChild) {\n                    document.head.insertBefore(link, document.head.firstChild);\n                } else {\n                    document.head.appendChild(link);\n                }\n            } else if (document.body) {\n                document.body.appendChild(link);\n            } else {\n                setTimeout(createLink, 200);\n            }\n        } catch (e) {\n            console.error(`插入CSS失败：`, e);\n            isLoadingCss = false;\n            setTimeout(createLink, 1000);\n        }\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        createLink();\n    } else {\n        document.addEventListener('DOMContentLoaded', createLink);\n    }\n}\n\n// ✅ 核心优化3：移除旧CSS（增加存在性检查）\nfunction removeOldCustomCss() {\n    try {\n        if (cssLinkElement) {\n            cssLinkElement.remove();\n            console.log(`已移除旧CSS：${cssLinkElement.href}`);\n        }\n        const preloadLinks = document.querySelectorAll(`link[rel=\"preload\"][href*=\"server.kexuny.cn/work/\"]`);\n        preloadLinks.forEach(link => link.remove());\n    } catch (e) {\n        console.error(`移除旧CSS失败：`, e);\n    }\n    currentCssKey = null;\n    isCssLoaded = false;\n    cssLinkElement = null;\n}\n\n// ✅ 核心优化4：CSS加载控制（优化逻辑顺序，新增提现页面JS加载）\nfunction loadCurrentPageCss() {\n    if (!isTargetDomain()) return;\n    \n    const newPageType = getCurrentPageType();\n    \n    // 未知页面：清理CSS\n    if (newPageType === 'unknown') {\n        if (currentCssKey!== null) {\n            console.log('当前页面无对应CSS配置，清理旧样式');\n            removeOldCustomCss();\n        }\n        return;\n    }\n    \n    // 页面类型变化：清理旧CSS + 预加载新CSS\n    if (newPageType!== currentCssKey) {\n        removeOldCustomCss();\n        currentCssKey = newPageType;\n        preloadCss(newPageType);\n        // 立即加载JS（shop页面或提现页面）\n        if (newPageType === 'shop') {\n            loadRemoteShopJs();\n        } else if (newPageType === 'settlement') { // 新增提现页面JS加载\n            loadRemoteSettlementJs();\n        } else if (newPageType === 'mine') { // 【改动8】新增mine页面JS加载\n            loadRemoteMineJs();\n        }\n        return;\n    }\n    \n    // 页面类型未变，但CSS未加载：立即加载\n    if (!isCssLoaded &&!isLoadingCss) {\n        loadCss(newPageType);\n    }\n    \n    // 确保JS加载（shop页面或提现页面）\n    if (newPageType === 'shop') {\n        loadRemoteShopJs();\n    } else if (newPageType === 'settlement') { // 新增提现页面JS加载\n        loadRemoteSettlementJs();\n    } else if (newPageType === 'mine') { // 【改动9】新增mine页面JS加载\n        loadRemoteMineJs();\n    }\n}\n\n// 5. 加载外部JS（保持不变+增加DOM检查）\nfunction loadExternalScript(url) {\n    if (!isTargetDomain()) return;\n    \n    const existingScript = document.querySelector(`script[src=\"${url}\"]`);\n    if (existingScript) {\n        console.log(`备用JS已加载：${url}`);\n        if (isLoginPage()) initLoginEventOnly();\n        return;\n    }\n    \n    const createScript = () => {\n        const script = document.createElement('script');\n        script.src = url;\n        script.type = 'text/javascript';\n        script.async = false;\n        script.defer = false;\n        \n        script.onload = function() {\n            console.log(`备用JS加载成功：${url}`);\n            console.log('备用JS仅启用事件响应，屏蔽样式操作');\n            if (typeof window.hideElements === 'function') {\n                const originalHideElements = window.hideElements;\n                window.hideElements = function() {\n                    try {\n                        console.log('屏蔽hideElements中的样式操作，仅保留事件逻辑');\n                        if (isLoginPage()) initLoginEventOnly();\n                    } catch (e) {\n                        console.error('重写hideElements执行出错：', e);\n                    }\n                };\n                console.log('已重写hideElements，仅保留事件功能');\n            } else {\n                if (isLoginPage()) initLoginEventOnly();\n            }\n        };\n        \n        script.onerror = function() {\n            console.error(`备用JS加载失败：${url}`);\n            retryLoadJs(url, 3, 2000);\n        };\n        \n        // 安全插入脚本\n        if (document.head) {\n            document.head.appendChild(script);\n        } else if (document.body) {\n            document.body.appendChild(script);\n        } else {\n            setTimeout(createScript, 200);\n        }\n    };\n    \n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n        createScript();\n    } else {\n        document.addEventListener('DOMContentLoaded', createScript);\n    }\n}\n\n// 6. JS重试加载（保持不变）\nfunction retryLoadJs(url, maxRetries, delay) {\n    let retries = 0;\n    const attemptLoad = () => {\n        retries++;\n        if (retries <= maxRetries) {\n            console.log(`备用JS第${retries}次重试加载：${url}`);\n            setTimeout(() => loadExternalScript(url), delay);\n        } else {\n            console.error(`备用JS达到最大重试次数(${maxRetries})，尝试直接初始化事件`);\n            if (isLoginPage()) initLoginEventOnly();\n        }\n    };\n    attemptLoad();\n}\n\n// 7. 登录事件初始化（保持不变）\nfunction initLoginEventOnly() {\n    if (!isLoginPage()) return;\n    console.log('开始初始化登录事件响应（无样式操作）');\n    \n    const waitForLoginBtn = () => {\n        try {\n            const loginBtn = document.querySelector('.style-login-botton.ivu-btn[data-v-2f9eb9a7]');\n            if (!loginBtn) {\n                setTimeout(waitForLoginBtn, 1000);\n                return;\n            }\n            \n            loginBtn.removeEventListener('click', handleLoginClick);\n            function handleLoginClick(e) {\n                try {\n                    if (loginBtn.__vue__) {\n                        const vueInstance = loginBtn.__vue__;\n                        const commonLoginMethods = ['handleLogin', 'submitLogin', 'onLogin', 'login'];\n                        for (const method of commonLoginMethods) {\n                            if (typeof vueInstance[method] === 'function') {\n                                vueInstance[method]();\n                                console.log(`登录事件：通过Vue方法[${method}]触发`);\n                                return;\n                            }\n                        }\n                    }\n                    \n                    const loginForm = loginBtn.closest('form.ivu-form');\n                    if (loginForm) {\n                        e.preventDefault();\n                        const submitEvent = new Event('submit', { bubbles: true, cancelable: true });\n                        loginForm.dispatchEvent(submitEvent);\n                        console.log(`登录事件：通过表单submit触发`);\n                        return;\n                    }\n                    \n                    const nativeClickEvent = new MouseEvent('click', {\n                        bubbles: true,\n                        cancelable: true,\n                        view: window\n                    });\n                    loginBtn.dispatchEvent(nativeClickEvent);\n                    console.log(`登录事件：通过原生点击事件触发`);\n                } catch (e) {\n                    console.error('处理登录点击失败：', e);\n                }\n            }\n            \n            loginBtn.addEventListener('click', handleLoginClick);\n            console.log('登录事件响应初始化完成（无样式干扰）');\n        } catch (e) {\n            console.error('初始化登录事件失败：', e);\n            setTimeout(waitForLoginBtn, 1000);\n        }\n    };\n    \n    waitForLoginBtn();\n}\n\n// 8. Chunk加载失败处理（保持不变+增加DOM检查）\nwindow.addEventListener('error', function(e) {\n    if (!isTargetDomain()) return;\n    if (e.target && e.target.tagName === 'SCRIPT' && e.target.src && e.target.src.includes('chunk')) {\n        console.error(`Chunk加载失败：${e.target.src}`);\n        retryLoadJs(e.target.src, 3, 3000);\n    }\n}, true);\n\n// 9. 点击事件处理（保持不变+增加DOM检查）\nconst hookClick = (e) => {\n    if (!isTargetDomain()) return;\n    try {\n        const origin = e.target.closest('a');\n        const isBaseTargetBlank = document.querySelector('head base[target=\"_blank\"]');\n        if ((origin && origin.href && origin.target === '_blank') || (origin && origin.href && isBaseTargetBlank)) {\n            e.preventDefault();\n            console.log('处理新窗口链接：', origin.href);\n            location.href = origin.href;\n        }\n    } catch (e) {\n        console.error('处理点击事件失败：', e);\n    }\n};\n\nwindow.addEventListener('click', hookClick, true);\n\nwindow.open = function (url, target, features) {\n    if (!isTargetDomain()) return;\n    console.log('拦截window.open：', url);\n    location.href = url;\n};\n\n// ✅ 核心优化5：路由监听（优化防抖+增加DOM检查）\nfunction watchRouteChange() {\n    if (!isTargetDomain()) return;\n    \n    // 监听hash变化（增加防抖）\n    let hashChangeTimer = null;\n    window.addEventListener('hashchange', () => {\n        clearTimeout(hashChangeTimer);\n        hashChangeTimer = setTimeout(() => {\n            console.log('路由hash变化，触发CSS检查和JS加载');\n            loadCurrentPageCss();\n        }, 100); // 防抖100ms\n    }, { capture: true });\n    \n    // 监听Vue Router（增加存在性检查）\n    const checkVueRouter = () => {\n        try {\n            if (window.Vue && window.VueRouter) {\n                const router = window.app?._router || window.$router || window.router;\n                if (router && router.beforeEach) {\n                    router.beforeEach((to, from, next) => {\n                        console.log(`Vue Router即将切换：${from.path} → ${to.path}`);\n                        const newPageType = getCurrentPageType();\n                        if (newPageType!== currentCssKey) {\n                            preloadCss(newPageType);\n                        }\n                        // 提前加载JS（shop页面或提现页面）\n                        if (newPageType === 'shop') {\n                            loadRemoteShopJs();\n                        } else if (newPageType === 'settlement') { // 新增提现页面JS加载\n                            loadRemoteSettlementJs();\n                        } else if (newPageType === 'mine') { // 【改动10】新增mine页面JS加载\n                            loadRemoteMineJs();\n                        }\n                        next();\n                    });\n                    \n                    router.afterEach(() => {\n                        setTimeout(loadCurrentPageCss, 0);\n                    });\n                    \n                    console.log('已监听Vue Router并提前预加载CSS和JS');\n                    return;\n                }\n            }\n        } catch (e) {\n            console.error('监听Vue Router失败：', e);\n        }\n        setTimeout(checkVueRouter, 1000); // 重试\n    };\n    checkVueRouter();\n    \n    // 监听DOM变化（优化防抖+限制监听范围）\n    const initMutationObserver = () => {\n        try {\n            if (document.body) {\n                let mutationTimer = null;\n                const observer = new MutationObserver((mutations) => {\n                    clearTimeout(mutationTimer);\n                    mutationTimer = setTimeout(() => {\n                        const newPageType = getCurrentPageType();\n                        if (newPageType!== currentCssKey ||!isCssLoaded) {\n                            console.log('DOM稳定后触发CSS检查');\n                            loadCurrentPageCss();\n                        }\n                    }, 300);\n                });\n                observer.observe(document.body, { \n                    childList: true, \n                    subtree: true,\n                    attributes: false,\n                    characterData: false\n                });\n                console.log('MutationObserver初始化成功');\n                return;\n            }\n        } catch (e) {\n            console.error('初始化MutationObserver失败：', e);\n        }\n        setTimeout(initMutationObserver, 200); // 重试\n    };\n    initMutationObserver();\n}\n\n// 10. 启动入口（优化执行时机+增加DOM就绪检查）\nfunction init() {\n    if (!isTargetDomain()) return;\n    \n    // 初始化全局变量\n    window.lastPageFullPath = '';\n    window.mutationDebounceTimer = null;\n    \n    // 等待DOM完全就绪后执行\n    const start = () => {\n        currentCssKey = getCurrentPageType();\n        watchRouteChange();\n        loadCurrentPageCss();\n        console.log('脚本初始化完成');\n    };\n    \n    if (document.readyState === 'complete') {\n        start();\n    } else if (document.readyState === 'interactive') {\n        setTimeout(start, 100);\n    } else {\n        document.addEventListener('DOMContentLoaded', () => setTimeout(start, 100));\n        // 兜底：3秒后强制启动\n        setTimeout(start, 3000);\n    }\n}\n\n// 启动脚本\ninit();","isHtml":false,"htmlPath":"","htmlFiles":[],"prefix":"","pcRepo":"PakePlus-v2.1.3","iosRepo":"PakePlus-iOS-v2.1.3","androidRepo":"PakePlus-Android-v2.1.3","more":{"windows":{"label":"","title":"门店助手","url":"https://account.fuhaogou.com","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","width":800,"height":600,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"shadow":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"backgroundColor":null,"backgroundThrottling":null,"javascriptDisabled":false}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"dacfabbeab","showName":"门店助手","version":"1.5.0","webUrl":"https://account.fuhaogou.com","id":"ayoutuan.app.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":true,"safeArea":"all"},"android":{"name":"dacfabbeab","showName":"门店助手","version":"1.5.0","webUrl":"https://account.fuhaogou.com","id":"ayoutuan.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":true,"safeArea":"all"},"desktop":{"name":"dacfabbeab","showName":"门店助手","version":"1.5.0","id":"ayoutuan.app.desktop","desc":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","webUrl":"https://account.fuhaogou.com","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":false,"buildMethod":"local","debug":false}}